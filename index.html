<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title> f-tool </title>
    </head>
    <body>

        <div onlogin="loginCallback();" class="fb-login-button" data-max-rows="1" data-size="large" data-button-type="continue_with" data-show-faces="false" data-auto-logout-link="true" data-use-continue-as="true"></div>

        <p>
            <button onclick="getScope('email');">이메일 퍼미션 획득</button>
        </p>

        
        <script src="env/envkey.js"></script>
        <script>
        
            window.fbAsyncInit = function() {
                FB.init({
                appId      : API_KEY,
                xfbml      : true,
                version    : 'v2.10'
                });
                FB.AppEvents.logPageView();

                FB.getLoginStatus(checkStatus);

            };



            function loginCallback(e){
                FB.getLoginStatus(checkStatus);
            }




            function checkStatus(e) {
                
                if(e.status === 'connected'){
                    var 
                        auth = e.authResponse;

                    console.log(auth.accessToken, auth.expiresIn, auth.userID);

                    apiCallback();

                } 
            }

            function apiCallback(){
                /* get profile */
                FB.api('/me', function(e){
                    console.log('/me', e);
                });

                /* get permissions */
                FB.api('/me/permissions', function(e){
                    console.log('/me/permissions', e.data);
                });
                
                /* get email */
                FB.api('me/?fields=email', function(e){
                    console.log('/me/email', e);
                });                

            }

            function getScope(e){
                
                /* facebook permissions scope : https://developers.facebook.com/docs/facebook-login/permissions */
                
                FB.login(function(response) {
                    console.log(response);
                }, {scope: e});

            }

            
        </script>
        <script>

            (function(d, s, id){ var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) {return;}
                js = d.createElement(s); js.id = id;
                js.src = "//connect.facebook.net/ko_KR/sdk.js";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));

        </script> 
    </body>
</html>